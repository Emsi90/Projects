(function(){
    
    //toggle menu
    
    var menuBackground = document.querySelector('.background-menu');
    
    window.addEventListener('scroll', function(){
        
        if(scrollY > 100) {
            menuBackground.style.background = '#f38181';
        } else {
            menuBackground.style.background = 'transparent';
        }
        
    }, false);
    
    //Accordion
    
    var accordionClick = document.querySelectorAll('.content__accordion-header');
    var accordionDesc = document.querySelectorAll('.content__accordion-description');
    
    accordionClick.forEach(function(acc , index) {
        
        acc.onclick = function(e) {
            
            for(var i = 0; i < accordionDesc.length; i++) {
                console.log(accordionDesc[i]);
                accordionDesc[i].classList.remove('content__accordion-description-open');
            }
            
            accordionDesc[index].classList.add('content__accordion-description-open');

            
        };
        
    });
    
    // map block
    
    var map = document.querySelector('.content__map');
    var mapIframe = document.querySelector('.content__map-iframe');
    var opneMapText = document.querySelector('.content__open-map');
    
    map.addEventListener('click', function() {
        
        map.style.height = '600px';
        opneMapText.style.display = 'none';
        mapIframe.style.pointerEvents = 'auto';
        mapIframe.style.opacity = 1;
        
    }, false);
    
    map.addEventListener('mouseleave', function() {
        
        map.style.height = '200px';
        opneMapText.style.display = '';
        mapIframe.style.pointerEvents = 'none';
        mapIframe.style.opacity = 0.3;
        
    }, false);
    
})();

(function(){
    
    var hamburgerButton = document.querySelector('.hamburger'),
        hamburgerIcon = document.querySelector('.hamburger__icon'),
        slideMenu = document.querySelector('.menu__slide-menu');
    
    hamburgerButton.onclick = function() {
        
        hamburgerIcon.classList.toggle('open');
        slideMenu.classList.toggle('open');
        
    };
    
    
})();

(function(){
    
    var slides = document.querySelectorAll('.slider__slide');
    var timeBars = document.querySelectorAll('.slider__progressBar');
    
    
    [].forEach.call(slides, function(slide) {
       
        var currentIndex = 0;
        var width = 100;
        
        function switchImg() {

            slide.style.left = -width * currentIndex + '%';

        }

        function progressBar() {

            var barWidth = 0;
            var timeToProgress = setInterval(function() {

                barWidth += 1;

                if(barWidth > 100) {
                    clearInterval(timeToProgress);
                } else {
                    timeBars[currentIndex].value = barWidth;
                }

            }, 40);

        }

        progressBar();

        var tickTock = setInterval(function() {

            progressBar();
            timeBars[currentIndex].value = 0;

            currentIndex++;
            switchImg();

            if(currentIndex > slides.length - 1) {
                slide.style.left = 0;
                currentIndex = 0;
            }

        }, 4001);
    
        
    });
    
})();

(function(){
    
    function Counter(counter, container) {
    
    this.counter = counter;
    this.container = container;
    this.noRepeat = true;

    document.addEventListener('scroll', this.startCounter.bind(this), false);
    
    }

    Counter.prototype.startCounter = function() {

        [].forEach.call(this.counter, function(elem) {


            var posTop = (elem.offsetTop - this.container.offsetTop / 2) + (this.container.offsetHeight / 2) - (elem.offsetHeight);
            var register = 0;

    //        console.log(this.container.offsetTop);
//            console.log(elem.offsetTop);
//            console.log((elem.offsetTop));
//            console.log(Math.round(scrollY));
            if((elem.offsetTop - posTop) <= Math.round(scrollY) && this.noRepeat) {

//                console.log('yes');

                var goCounter = setInterval(function(){

                    this.noRepeat = false;
                    if(register <= elem.dataset.scope) {
                        elem.textContent = register++;
                    } else {
                        clearInterval(goCounter);
                    }

                }.bind(this), 100);

            }

        }.bind(this));

    };
    
    var counter = new Counter(document.querySelectorAll('.counter'), document.querySelector('.content__counters'));
    
})();

(function(){
var carusel = document.querySelectorAll('.content__testimonials-container');

console.log(carusel);
[].forEach.call(carusel, function(c) {
   
    var prev = c.querySelector('.content__testimonial-prev');
    var next = c.querySelector('.content__testimonial-next');
//    var bubbles = c.getElementsByClassName('carusel__bubbles')[0];
    var testimonials = c.querySelector('.content__testimonials');
    var testimonial = c.getElementsByClassName('content__testimonial');
//    console.log(testimonial);
    
    var currentImageIndex = 0;
    var width = 100;
//    var arrBubbles = [];
    
//    for(var i = 0; i < testimonial.length; i++) {
//        
//        var b = document.createElement('span');
//        b.classList.add('carusel__bubble');
//        bubbles.appendChild(b);
//        arrBubbles.push(b);
//        console.log(i);
//        
////        b.addEventListener('click', function(){
////            
////            currentImageIndex = i;
////            console.log(i);
////            switchImg();
////            
////        }, false);
//        
//        arrBubbles.forEach(function(b, i){
//            
//            b.addEventListener('click', function() {
//               
//                currentImageIndex = i;
//                switchImg();
//                
//            });
//            
//        }, false);
        
//    }
    
    function switchImg() {
        
        testimonials.style.left = -width * currentImageIndex + '%';
        
//        arrBubbles.forEach(function(b, i) {
//           
//           if(i === currentImageIndex) {
//               b.classList.add('carusel__bubble--active');
//           } else {
//               b.classList.remove('carusel__bubble--active');
//           }
//            
//        });
    }
    
    prev.addEventListener('click', function() {
        
        currentImageIndex--;
        
        if(currentImageIndex < 0) {
            
            currentImageIndex = testimonial.length - 1;
            
        }
        console.log(testimonial.length);
        switchImg();
        
    }, false);
    
    next.addEventListener('click', function() {
        
        currentImageIndex++;
        
        if(currentImageIndex >= testimonial.length) {
            
            currentImageIndex = 0;
            
        }
        
        switchImg();
        
    }, false);
    
    switchImg();
});
    
})();